<UserControl
    x:Class="Imgur.Uwp.Controls.AccountTileControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Imgur.Uwp.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
   xmlns:Interactivity="using:Microsoft.Xaml.Interactivity"
    xmlns:Core="using:Microsoft.Xaml.Interactions.Core"
    xmlns:contract5Present="http://schemas.microsoft.com/winfx/2006/xaml/presentation?IsApiContractPresent(Windows.Foundation.UniversalApiContract,5)"
    xmlns:toolkit="using:Microsoft.Toolkit.Uwp.UI.Controls"
    xmlns:winui="using:Microsoft.UI.Xaml.Controls"
    d:DesignHeight="300"
    d:DesignWidth="220">

    <Grid>
        <toolkit:DropShadowPanel 
        x:Name="AccountElement" 
        BlurRadius="10" 
        OffsetX="0" 
        OffsetY="2" 
        ShadowOpacity="0.5" 
        HorizontalAlignment="Stretch"
        VerticalAlignment="Stretch"
        HorizontalContentAlignment="Stretch" 
        VerticalContentAlignment="Stretch"   
        Margin="6">
            <Grid Background="#3F4147" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" CornerRadius="5">
                <Grid.RowDefinitions>
                    <RowDefinition  />
                    <RowDefinition MaxHeight="90"  />
                </Grid.RowDefinitions>

                <!-- Loading -->
                <winui:ProgressBar  x:Name="LoadingBar" VerticalAlignment="Top" MinHeight="4" IsEnabled="True" IsIndeterminate="True"  Margin="2,1,2,0" Foreground="White" />

                <!-- Data Container -->
                <Grid x:Name="accountContainer" Grid.RowSpan="1">
                    <Border CornerRadius="5">
                        <Border.Background>
                            <ImageBrush x:Name="mediaThumb" Stretch="UniformToFill"  ImageSource="{Binding UserAccountInfo.Cover,Mode=OneWay}"/>
                        </Border.Background>
                    </Border>
                    
                </Grid>
                <toolkit:DropShadowPanel 
                    BlurRadius="10" 
                    OffsetX="0" 
                    Margin="12"
                    ShadowOpacity="0.5" 
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Grid.Row="0" 
                    OffsetY="1" >
                    <Button  Width="25" Height="25" Padding="0" Style="{StaticResource CircleButtonStyle}" Command="{Binding Path=FollowAuthor }" Background="#FFF">
                        <FontIcon FontFamily="{StaticResource FluentUIGlyphs}" FontWeight="ExtraBold" FontSize="12" Glyph="&#xE948;" Foreground="Black" Margin="0,1,0,0" HorizontalAlignment="Center" />
                    </Button>
                </toolkit:DropShadowPanel>
                <StackPanel x:Name="accountInfoContainer" Orientation="Horizontal" VerticalAlignment="Top" Opacity="0.9" HorizontalAlignment="Right" Margin="15" Grid.Row="0"/>
                <Grid Grid.Row="1" x:Name="AccountFooter" Background="#474a51"  RequestedTheme="Dark" Margin="-1" CornerRadius="0,0,5,5" Opacity="0.9">
                    <Grid Grid.Row="2" Margin="0,20,0,0" Padding="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"  />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Margin="10,0,10,0" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" HorizontalAlignment="Center" ToolTipService.ToolTip="{Binding UserAccountInfo.Username,Mode=OneWay}" FontWeight="SemiBold"  Text="{Binding UserAccountInfo.Username,FallbackValue='Username',Mode=OneWay }"/>

                        <TextBlock Grid.Row="1" Margin="0,0,0,0" Foreground="#ACB0BA" TextWrapping="Wrap" TextTrimming="CharacterEllipsis" HorizontalAlignment="Center" ToolTipService.ToolTip="{Binding UserAccountInfo.ReputationName,Mode=OneWay}" FontWeight="SemiBold"   Text="{Binding UserAccountInfo.ReputationName,FallbackValue='Username',Mode=OneWay }"/>
                    </Grid>
                </Grid>
                <toolkit:DropShadowPanel 
                    BlurRadius="50" 
                    OffsetX="0" 
                    ShadowOpacity="0.5" 
                    Grid.Row="1"  Margin="0,-60,0,0" HorizontalAlignment="Center" VerticalAlignment="Top"
                    OffsetY="1" >
                    <Grid Background="{StaticResource SystemControlAcrylicElementBrush}" Width="80" Height="80" CornerRadius="40" Padding="0">
                       

                        <ProgressRing x:Name="LoadingAvatarRing" VerticalAlignment="Center"  Width="60" Height="50" Margin="0,0,0,0" IsActive="True"  />
                        <FontIcon  Grid.RowSpan="2" FontFamily="{StaticResource FluentUIGlyphs}" FontSize="30" Foreground="#01b96b" Margin="0,0,0,0" Glyph="&#xe8d4;"/>
                        <Ellipse Width="80" Height="80"   >
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding UserAccountInfo.Avatar}" Stretch="UniformToFill"/>
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>

                </toolkit:DropShadowPanel>
            </Grid>

            <Interactivity:Interaction.Behaviors>
                <Core:EventTriggerBehavior EventName="Tapped">
                    <Core:InvokeCommandAction Command="{Binding NavigateAccountViewCommand}"/>
                </Core:EventTriggerBehavior>
            </Interactivity:Interaction.Behaviors>

        </toolkit:DropShadowPanel>
    </Grid>
</UserControl>

