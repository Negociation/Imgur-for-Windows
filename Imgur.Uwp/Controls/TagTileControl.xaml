<UserControl
    x:Class="Imgur.Uwp.Controls.TagTileControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Imgur.Uwp.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    xmlns:Interactivity="using:Microsoft.Xaml.Interactivity"
    xmlns:Core="using:Microsoft.Xaml.Interactions.Core"
    xmlns:contract5Present="http://schemas.microsoft.com/winfx/2006/xaml/presentation?IsApiContractPresent(Windows.Foundation.UniversalApiContract,5)"
    xmlns:toolkit="using:Microsoft.Toolkit.Uwp.UI.Controls"
    d:DesignHeight="300"
    d:DesignWidth="220">

    <Grid>
        <toolkit:DropShadowPanel 
        x:Name="TagElement" 
        BlurRadius="10" 
        OffsetX="0" 
        OffsetY="2" 
        ShadowOpacity="0.5" 
        HorizontalAlignment="Stretch"
        VerticalAlignment="Stretch"
        HorizontalContentAlignment="Stretch" 
        VerticalContentAlignment="Stretch"   
        Margin="6">
            <Grid Background="#3F4147" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" CornerRadius="5">
                <Grid.RowDefinitions>
                    <RowDefinition  />
                    <RowDefinition MaxHeight="90"  />
                </Grid.RowDefinitions>

                <!-- Loading -->
                <ProgressRing x:Name="LoadingRing" VerticalAlignment="Center" Grid.RowSpan="2" Width="40" Height="50" Margin="0,0,0,100" IsActive="True"  />
                <FontIcon  Grid.RowSpan="2" FontFamily="{StaticResource FluentUIGlyphs}" FontSize="18" Foreground="#01b96b" Margin="0,0,0,95" Glyph="&#xe8ec;"/>

                <!-- Data Container -->


                <Grid x:Name="tagContainer" Grid.RowSpan="1" Visibility="Visible">
                    <Border CornerRadius="5">
                        <Border.Background>
                            <ImageBrush x:Name="tagThumb" Stretch="UniformToFill" ImageSource="{Binding CurrentTag.BackgroundTile,Mode=OneWay}" />
                        </Border.Background>
                    </Border>
                </Grid>
                

                <StackPanel x:Name="tagInfoContainer" Orientation="Horizontal" VerticalAlignment="Top" Opacity="0.9" HorizontalAlignment="Right" Margin="15" Grid.Row="0"/>
                <Grid Grid.Row="1" x:Name="TagFooter" Background="#474a51"  RequestedTheme="Dark" Margin="0" CornerRadius="0,0,5,5" Opacity="0.9">
                    <Grid Grid.Row="2" Margin="0,20,0,0" Padding="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="30"  />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Margin="10,0,10,0" TextWrapping="Wrap" TextTrimming="CharacterEllipsis" HorizontalAlignment="Center" ToolTipService.ToolTip="{Binding  CurrentTag.Background,Mode=OneWay}" FontWeight="SemiBold"  Text="{Binding CurrentTag.Title,FallbackValue='Tag Title',Mode=OneWay }"/>
                        <StackPanel Margin="0,0,0,0" Grid.Column="0" Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center">
                            <FontIcon FontFamily="{StaticResource FluentUIGlyphs}"  VerticalAlignment="Center" Glyph="&#xe838;" Foreground="#B0B5BF" FontWeight="ExtraBold" FontSize="16"/>
                            <TextBlock FontSize="14" TextAlignment="End" Margin="5,2,0,0"  Foreground="#B0B5BF" FontWeight="SemiBold" Text="{Binding CurrentTag.ItemsCount,FallbackValue=0,Mode=OneWay}"/>
                        </StackPanel>
                    </Grid>
                </Grid>
                <toolkit:DropShadowPanel 
                    Grid.Row="1" 
                    BlurRadius="20" 
                    OffsetX="0" 
                    Margin="0,-15,0,0"
                OffsetY="2" 
                ShadowOpacity="0.5" 
                HorizontalContentAlignment="Stretch" 
                    HorizontalAlignment="Center" VerticalAlignment="Top" 
                    Padding="50,0"
                VerticalContentAlignment="Stretch">
                    <Button   Style="{StaticResource FollowButtonStyle}" Command="{Binding FollowTagCommand}"  Opacity="1">
                        <TextBlock x:Uid="Follow"></TextBlock>
                    </Button>
                </toolkit:DropShadowPanel>
            </Grid>

            <Interactivity:Interaction.Behaviors>
                <Core:EventTriggerBehavior EventName="Tapped">
                    <Core:InvokeCommandAction Command="{Binding NavigateTagCommand}"/>
                </Core:EventTriggerBehavior>
            </Interactivity:Interaction.Behaviors>

        </toolkit:DropShadowPanel>
    </Grid>
</UserControl>
