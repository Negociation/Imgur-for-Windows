<Page
    x:Name="MediaViewPage"
    x:Class="Imgur.Uwp.Views.Media.MediaView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Imgur.UWP.Views.Media"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:Windows10version1903="http://schemas.microsoft.com/winfx/2006/xaml/presentation?IsApiContractPresent(Windows.Foundation.UniversalApiContract, 8)"
    xmlns:winui="using:Microsoft.UI.Xaml.Controls"
    xmlns:Windows10version1803="http://schemas.microsoft.com/winfx/2006/xaml/presentation?IsApiContractPresent(Windows.Foundation.UniversalApiContract, 6)"
    xmlns:Interactivity="using:Microsoft.Xaml.Interactivity"
    xmlns:Core="using:Microsoft.Xaml.Interactions.Core"
    xmlns:toolkit="using:Microsoft.Toolkit.Uwp.UI.Controls"
    xmlns:models="using:Imgur.Models"
    xmlns:local1="using:Imgur.Uwp.TemplateSelectors"
    xmlns:controls="using:Imgur.Uwp.Controls"
    mc:Ignorable="d">
    <Page.Resources>
        <Style TargetType="CommandBar">
            <Setter Property="Background" Value="#333"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CommandBar">
                        <Grid>
                            <!-- Your customizations here -->
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <DataTemplate x:Key="ImageTemplate" x:DataType="models:Element">
            <StackPanel Margin="0,10" MinHeight="100">

                <controls:ImageViewElementControl ImageElement="{Binding}" HorizontalAlignment="Stretch" />

                <TextBlock FontWeight="Bold"  Text="{Binding Title}"  TextWrapping="Wrap" Margin="10,0,10,0" IsTextSelectionEnabled="True" />
                <TextBlock FontWeight="SemiBold" Text="{Binding Description}" TextWrapping="Wrap" Margin="10,0,10,5" IsTextSelectionEnabled="True" />
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="VideoTemplate" x:DataType="models:Element">
            <StackPanel HorizontalAlignment="Stretch" Margin="0,0,0,10">
                <Grid>
                    <controls:VideoViewElementControl MediaElement="{Binding}" HorizontalAlignment="Stretch" />
                </Grid>
                <TextBlock FontWeight="Bold" Text="{Binding Title}" TextWrapping="Wrap" Margin="10,0,10,0" IsTextSelectionEnabled="True" />
                <TextBlock FontWeight="SemiBold" Text="{Binding Description}" TextWrapping="Wrap" Margin="10,0,10,5" IsTextSelectionEnabled="True" />
            </StackPanel>

        </DataTemplate>
        <local1:MediaElementTemplateSelector x:Key="MediaDataTemplateSelector" ImageTemplate="{StaticResource ImageTemplate}" VideoTemplate="{StaticResource VideoTemplate}" />
    </Page.Resources>

    <Grid x:Name="RootGrid" Margin="0,0,0,0" SizeChanged="RootGrid_SizeChanged"  MaxWidth="1100" >
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup  x:Uid="PageTriggers">
                <VisualState x:Name="Minimal">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="300" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="RootGrid.Margin" Value="0,-13,0,0" />
                        <Setter Target="MediaPlacement.Margin" Value="0" />
                        <Setter Target="MediaPlacement.Padding" Value="0,0,0,5" />
                        <Setter Target="CommentsPlacementBorder.Margin" Value="0,0,0,90" />
                        <Setter Target="CommentsPlacement.CornerRadius" Value="0" />
                        <Setter Target="MediaPlacement.CornerRadius" Value="0" />
                        <Setter Target="MediaPlacement.Background" Value="Transparent" />
                        <Setter Target="DockCommandBar.Margin" Value="30,0,0,0" />
                        <Setter Target="CompactBottomBar.Visibility" Value="Visible" />
                        <Setter Target="LeaveFloatButton.Margin" Value="5,18,0,0" />
                        <Setter Target="DockTitle.FontSize" Value="14" />
                        <Setter Target="DockDyanmicData.FontSize" Value="10" />
                        <Setter Target="DockCommands.MaxWidth" Value="40" />
                        <Setter Target="AppBarFavouriteButton.LabelPosition" Value="Collapsed" />
                        <Setter Target="AppBarFavouriteButton.Margin" Value="0" />
                        <Setter Target="ToggleThemeTeachingTip1.IsOpen" Value="False" />
                    </VisualState.Setters>
                    <VisualState.Storyboard>
                        <Storyboard>
                        </Storyboard>
                    </VisualState.Storyboard>
                </VisualState>
                <VisualState x:Name="Compact">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="500" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="CommentsPlacement.CornerRadius" Value="5" />
                        <Setter Target="CommentsPlacementBorder.Margin" Value="5,0,10,70" />
                        <Setter Target="DockTitle.FontSize" Value="14" />
                        <Setter Target="DockDyanmicData.FontSize" Value="10" />
                        <Setter Target="LeaveFloatButton.Margin" Value="11,25,0,0" />
                        <Setter Target="BottomNavigationBar.Visibility" Value="Visible"/>
                        <Setter Target="FloatCommandBar.Visibility" Value="Visible"/>
                    </VisualState.Setters>
                    <VisualState.Storyboard>
                        <Storyboard>

                        </Storyboard>
                    </VisualState.Storyboard>
                </VisualState>
                <VisualState x:Name="Extended">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1000" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="CompactVerticalBar.Visibility" Value="Visible" />
                        <Setter Target="CommentsPlacementBorder.Margin" Value="0,0,10,10" />
                        <Setter Target="CommentsPlacementBorder.(Grid.Row)" Value="1" />
                        <Setter Target="CommentsPlacementBorder.(Grid.Column)" Value="1" />
                        <Setter Target="CommentsPlacementBorder.ShadowOpacity" Value="0.4" />
                        <Setter Target="CommentsPlacementBorder.OffsetY" Value="0" />
                        <Setter Target="CommentsPlacementBorder.OffsetX" Value="-2" />
                        <Setter Target="CommentsPlacementBorder.VerticalAlignment" Value="Stretch" />
                        <Setter Target="CommentsPlacement.VerticalAlignment" Value="Stretch" />
                        <Setter Target="MediaPlacement.(Grid.Row)" Value="1" />
                        <Setter Target="MediaPlacement.(Grid.ColumnSpan)" Value="1" />
                        <Setter Target="MediaPlacement.Margin" Value="5,0,0,10" />
                        <Setter Target="MediaPlacement.CornerRadius" Value="5,0,0,5" />
                        <Setter Target="DockDyanmicData.Margin" Value="0,-4" />
                        <Setter Target="MediaRepeater.(ScrollViewer.VerticalScrollMode)" Value="Auto" />
                        <Setter Target="RootScrollView.(Grid.Column)" Value="1" />
                        <Setter Target="RootScrollView.(Grid.ColumnSpan)" Value="1" />
                        <Setter Target="LeaveFloatButton.(Grid.Column)" Value="1" />
                        <Setter Target="LeaveFloatButton.(Grid.ColumnSpan)" Value="1" />
                        <Setter Target="RootGrid.MaxHeight" Value="900" />
                    </VisualState.Setters>
                    <VisualState.Storyboard>
                        <Storyboard>

                        </Storyboard>
                    </VisualState.Storyboard>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="auto" />
        </Grid.ColumnDefinitions>

        <!-- Loading Overlay -->
        <Grid x:Name="LoadingOverlay" Grid.ColumnSpan="3" Background="{ThemeResource SystemControlChromeLowAcrylicWindowBrush}" Opacity="0.97" Canvas.ZIndex="100"  Visibility="{Binding LoadingElementsStatus,Mode=OneWay}" HorizontalAlignment="Stretch">
            <StackPanel HorizontalAlignment="Stretch" VerticalAlignment="Center" Opacity="0.7">
                <TextBlock FontWeight="Bold"  FontSize="16" HorizontalAlignment="Center">Getting the hot stuff!</TextBlock>
                <ProgressBar HorizontalAlignment="Stretch" IsIndeterminate="True" Margin="20,5" />
            </StackPanel>
        </Grid>
        
        <!-- View Content -->
        <ScrollViewer x:Name="RootScrollView" Grid.Column="0" Grid.ColumnSpan="3" HorizontalAlignment="Stretch" ViewChanged="RootScrollView_ViewChanged" >

            <Grid x:Name="RootScrollGrid">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="0.60*" MaxWidth="800"/>
                    <ColumnDefinition Width="0.40*" MaxWidth="400" MinWidth="300" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <Grid x:Name="MediaPlacement" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" Background="#232424"  Margin="5,10,10,10" Padding="0,0,0,20" CornerRadius="5" MinHeight="200" VerticalAlignment="Stretch">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Media Title and Command Bar -->
                    <Grid x:Name="DockCommandBar" Margin="30,0,0,0" VerticalAlignment="Top" Height="80" Padding ="15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto" />
                            <RowDefinition Height="auto" />
                            <RowDefinition Height="auto" />
                        </Grid.RowDefinitions>
                        <TextBlock x:Name="DockTitle" Grid.Column="0" ToolTipService.ToolTip="{Binding CurrentMedia.Title}" Margin="0,2,15,0" FontSize="18" FontWeight="SemiBold" TextTrimming="CharacterEllipsis" Text="{Binding Path=CurrentMedia.Title}" />
                        <Grid Visibility="{Binding ReloadingCurrentMediaInfo,Converter={StaticResource BoolNegationConverter}}" Grid.Column="0" Grid.Row="1">
                            <TextBlock x:Name="DockDyanmicData"  Margin="0,0,0,0" FontSize="12">
                                <Run Text="{Binding CurrentMedia.Views}" />
                                <Run x:Uid="Views" Text=" Views"></Run>       
                                <Run Text=" • "></Run>              
                               
                                <Run Text="{Binding CurrentMedia.DateTime,Converter={StaticResource TimestampToElapsedTimeConverter}}" FontFamily="Segoe UI"></Run>
                            </TextBlock>
                        </Grid>
                        <ProgressBar IsIndeterminate="{Binding ReloadingCurrentMediaInfo}" Grid.Row="1" Visibility="{Binding ReloadingCurrentMediaInfo}" Margin="0,-10,0,0" HorizontalAlignment="Stretch" Foreground="White"  Grid.ColumnSpan="2" />

                        <Grid Grid.Row="2" Margin="0,-5" Visibility="{Binding LoadedSuccessfully}">
                            <Grid  DataContext="{Binding UserAccount}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="auto"  />
                                    <ColumnDefinition Width="auto"  />
                                </Grid.ColumnDefinitions>
                                <TextBlock FontWeight="SemiBold"  Text="{Binding UserAccountInfo.Username,FallbackValue='...'}" Opacity="0.7" FontSize="12">
                                <Interactivity:Interaction.Behaviors>
                                    <Core:EventTriggerBehavior EventName="Tapped">
                                            
                                
                                    </Core:EventTriggerBehavior>
                                </Interactivity:Interaction.Behaviors>
                                </TextBlock>
                                <Button Grid.Column="1"  Width="18" Height="18" Padding="0" Style="{StaticResource CircleButtonStyle}" Command="{Binding Path=FollowAuthor }" Background="#BCC0C9"  Margin="5,0" Opacity="0.4">
                                    <FontIcon FontFamily="{StaticResource FluentUIGlyphs}" FontWeight="ExtraBold" FontSize="12" Glyph="&#xE948;" Foreground="Black" Margin="0,1,0,0" HorizontalAlignment="Center" />
                                </Button>
                            </Grid>
                        </Grid>
                        <CommandBar Style="{x:Null}" x:Name="DockCommands" Grid.Column="1"  Margin="0" VerticalAlignment="Top"  Grid.Row="0"  Grid.RowSpan="2" Background="Transparent" IsOpen="False" DefaultLabelPosition="Right">
                            <AppBarButton x:Uid="AppBarFavouriteButton" x:Name="AppBarFavouriteButton"  Margin="-10,-2,0,0" Command="{Binding Favourite}" ToolTipService.ToolTip="Add to Favourites" Visibility="Visible" Label="Add to Favourites" LabelPosition="Collapsed">
                                <AppBarButton.Icon>
                                    <FontIcon FontFamily="ms-appx:///Assets/Fonts/segmdl3.ttf#Segoe MDL2 Assets" FontSize="20" Glyph="&#xEB51;"/>
                                </AppBarButton.Icon>
                            </AppBarButton>
                            <CommandBar.SecondaryCommands>
                                <AppBarButton x:Uid="AppBarShare" Label="Share to..." ToolTipService.ToolTip="Share the content" FontFamily="Segoe MDL2 Assets" IsEnabled="True"  Command="{Binding InvokeShareDialog}">
                                    <AppBarButton.Icon>
                                        <FontIcon FontFamily="ms-appx:///Assets/Fonts/segmdl2.ttf#Segoe MDL2 Assets" FontSize="18" Glyph="&#xE72D;"/>
                                    </AppBarButton.Icon>
                                </AppBarButton>
                                <AppBarButton x:Uid="AppBarCopy" Label="Copy to Clipboard" ToolTipService.ToolTip="Copy the URL to Clipboard" Command="{Binding Copy}" CommandParameter="{Binding GalleryElement.Url,ElementName=GalleryDockControl}" >
                                    <AppBarButton.Icon>
                                        <FontIcon FontFamily="ms-appx:///Assets/Fonts/segmdl2.ttf#Segoe MDL2 Assets" FontSize="18" Glyph="&#xE8C8;"/>
                                    </AppBarButton.Icon>
                                </AppBarButton>
                                <AppBarSeparator></AppBarSeparator>
                                <AppBarButton x:Uid="AppBarDownload" Icon="Download" Label="Download" ToolTipService.ToolTip="Download the content" IsEnabled="False"></AppBarButton>
                                <AppBarButton x:Uid="AppBarEmbed" Label="Embed" ToolTipService.ToolTip="Embed the content" Command="{Binding InvokeEmbedDialog}">
                                    <AppBarButton.Icon>
                                        <FontIcon FontFamily="ms-appx:///Assets/Fonts/segmdl3.ttf#Segoe MDL2 Assets" FontSize="18" Glyph="&#xE943;"/>
                                    </AppBarButton.Icon>
                                </AppBarButton>
                            </CommandBar.SecondaryCommands>
                        </CommandBar>
                    </Grid>
                    
                    <!-- Itens View (Elements) -->
                    <ListView x:Name="MediaRepeater" VerticalAlignment="Center" Grid.Row="1" Visibility="{Binding LoadedSuccessfully}"  MinHeight="200" MaxHeight="{Binding CurrentMedia.Elements.Count, Converter={StaticResource ItemCountToMaxHeightConverter}}" BorderThickness="0" ScrollViewer.VerticalScrollMode="Disabled"  SelectionMode="None" Margin="0,5,0,0" ItemTemplateSelector="{StaticResource MediaDataTemplateSelector}" ItemsSource="{Binding CurrentMedia.Elements,Mode=OneWay}">
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                <Setter Property="Padding" Value="0" />
                            </Style>
                        </ListView.ItemContainerStyle>
                    </ListView>
                    
                    <!-- Append More Button -->
                    <Grid  Grid.Row="2" HorizontalAlignment="Stretch" Visibility="{Binding IsPartialLoading}">
                        <Button Visibility="{Binding IsAppendingMediaData, Converter={StaticResource BoolNegationConverter}}" HorizontalAlignment="Center"  Command="{Binding LoadRemaningItensCommand}" VerticalAlignment="Center" Margin="0, 0, 00, 40" Style="{StaticResource AppRoundedButtonStyle}">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock x:Uid="LoadMore"/>
                                <TextBlock Margin="4,0,0,0" FontWeight="SemiBold" Text="{Binding RemainingItemsCount}"  />
                            </StackPanel>
                        </Button>

                        <ProgressBar HorizontalAlignment="Stretch" IsIndeterminate="True" Margin="50,15" Visibility="{Binding IsAppendingMediaData}" />
                    </Grid>


                    <!-- Refresh Error View -->
                    <Grid x:Name="RefreshGrid" Grid.Row="1"  VerticalAlignment="Center" Visibility="{Binding LoadingElementsStatus,Converter={StaticResource BoolNegationConverter}}">
                        <StackPanel  VerticalAlignment="Center" Margin="0,30" Visibility="{Binding LoadedSuccessfully,Converter={StaticResource BoolNegationConverter}}">
                            <Image MaxWidth="250"   Source="ms-appx:///Assets/App/raccon.png" Margin="10,0,0,0" />
                            <TextBlock Margin="0,10,0,0" TextWrapping="Wrap" FontWeight="ExtraBold" TextAlignment="Center" FontSize="25">
                        Imgur, we have a problem.
                            </TextBlock>
                            <TextBlock Margin="0,10,0,0" TextWrapping="Wrap" TextAlignment="Center" FontSize="18"> Sorry, We're encountering some technical difficulties.</TextBlock>
                            <Button Margin="0,10,0,0" HorizontalAlignment="Center" MinWidth="200" Command="{Binding InitializeCommand}">Reload</Button>
                        </StackPanel>
                    </Grid>
                </Grid>

                <!-- Comments Area -->
                <toolkit:DropShadowPanel x:Name="CommentsPlacementBorder" Grid.Row="1" Grid.Column="0" Margin="0,10,10,10" Grid.ColumnSpan="2" BlurRadius="10" OffsetX="0" OffsetY="2" ShadowOpacity="0.5" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" VerticalAlignment="Top">
                    <Grid x:Name="CommentsPlacement" Background="#3d4140" CornerRadius="0,0,0,0"  VerticalAlignment="Top" MinHeight="150">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="34"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Button Grid.Column="0" HorizontalAlignment="Left" Background="Transparent" BorderBrush="Transparent">
                            <StackPanel Orientation="Horizontal" Opacity="0.7">
                                <FontIcon FontFamily="{StaticResource FluentUIGlyphs}" FontWeight="ExtraBold" FontSize="14" Glyph="&#xE8CB;" Margin="0,0,0,0" HorizontalAlignment="Center" />
                                <TextBlock FontSize="16" Margin="5,0" >BEST COMMENTS</TextBlock>
                            </StackPanel>
                        </Button>
                        <Button Grid.Column="1" HorizontalAlignment="Right" Background="Transparent" BorderBrush="Transparent">
                            <StackPanel Orientation="Horizontal" Opacity="0.7">
                                <FontIcon FontFamily="{StaticResource SegoeMDLGlyphs}" FontWeight="ExtraBold" FontSize="14" Glyph="&#xF716;" Margin="0,0,0,0" HorizontalAlignment="Center" />
                                <TextBlock FontSize="16" Margin="5,0" >COMMENT</TextBlock>
                            </StackPanel>
                        </Button>
                        <Grid Grid.Row="1" Grid.ColumnSpan="2" Visibility="Collapsed">

                        </Grid>

                        <Grid Grid.ColumnSpan="2" Grid.Row="1" Margin="0,0,20,0" Visibility="Visible">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="0.5*" />
                                <ColumnDefinition Width="0.5*" />
                            </Grid.ColumnDefinitions>
                            <RichTextBlock HorizontalAlignment="Left" VerticalAlignment="Bottom"  Padding="10" TextWrapping="Wrap">
                                <Paragraph Foreground="#b4b9c2">Looks like there aren't any comments yet.</Paragraph>
                                <Paragraph Foreground="SteelBlue">BE THE FIRST!</Paragraph>
                            </RichTextBlock>
                            <Image  MaxWidth="50" Opacity="0.7" Grid.Column="1"   HorizontalAlignment="Right" VerticalAlignment="Bottom"  Source="ms-appx:///Assets/App/giraffe_faded.png"  />
                        </Grid>
                    </Grid>
                </toolkit:DropShadowPanel>
            </Grid>
        </ScrollViewer>
        
        <!-- Desktop Vertical Bar-->
        <Grid Grid.Column="2" Visibility="Collapsed" x:Name="CompactVerticalBar" Background="Transparent" BorderBrush="#464b57" BorderThickness="2" CornerRadius="4" HorizontalAlignment="Center" Margin="10,0,15,0" VerticalAlignment="Center" Width="60">
            <StackPanel HorizontalAlignment="Center" Padding="5">
                <Button Background="Transparent" BorderBrush="Transparent" FocusVisualPrimaryBrush="{StaticResource SystemControlFocusVisualPrimaryBrush}" FocusVisualSecondaryBrush="{StaticResource SystemControlFocusVisualSecondaryBrush}" Width="40" Height="40" Padding="-5" Command="{Binding Vote}" CommandParameter="1">
                    <FontIcon FontSize="32" Foreground="White" FontFamily="{StaticResource ImgurGlyphs}" Glyph="&#xe90b;"/>
                </Button>

                <TextBlock HorizontalAlignment="Center" FontWeight="SemiBold" Text="{Binding CurrentMedia.Votes}" Margin="0,10" />

                <Button Background="Transparent" BorderBrush="Transparent" FocusVisualPrimaryBrush="{StaticResource SystemControlFocusVisualPrimaryBrush}" FocusVisualSecondaryBrush="{StaticResource SystemControlFocusVisualSecondaryBrush}"  Width="40" Height="40" Padding="-5" Command="{Binding Vote}" CommandParameter="0">
                    <Button.Content>
                        <FontIcon FontSize="32" Foreground="White" FontFamily="{StaticResource ImgurGlyphs}" Glyph="&#xe900;"/>
                    </Button.Content>
                </Button>
                
                
            </StackPanel>
        </Grid>
        
        <!-- Go Back Button -->
        <Button Grid.Column="0" x:Name="LeaveFloatButton" Command="{Binding LeaveCurrentPage}" VerticalAlignment="Top" Style="{StaticResource CircleButtonStyle}" Margin="11,18,0,0" Width="34" Height="34" Background="#232424" Opacity="0.9" >
            <FontIcon Visibility="Visible"  Grid.Column="0" FontSize="14" FontWeight="Normal" HorizontalAlignment="Center" VerticalAlignment="Center" FontFamily="{StaticResource FluentUIGlyphs}" Foreground="WhiteSmoke" Glyph="&#xE72B;"/>
        </Button>

        <!-- Compact Gray Bottom Bar -->
        <toolkit:DropShadowPanel x:Name="CompactBottomBar" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3" Visibility="Collapsed" Margin="10"  BlurRadius="20" OffsetX="0" OffsetY="2" ShadowOpacity="0.8" HorizontalContentAlignment="Stretch"  VerticalContentAlignment="Stretch" VerticalAlignment="Bottom">
            <Grid Background="#464b57" CornerRadius="15"  Height="56" Padding="5,0" >
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" MinWidth="150" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <StackPanel x:Name="LeftCommands" Orientation="Horizontal" Margin="10,0,10,0" HorizontalAlignment="Center" >
                    <Button Background="Transparent" BorderBrush="Transparent" FocusVisualPrimaryBrush="{StaticResource SystemControlFocusVisualPrimaryBrush}" FocusVisualSecondaryBrush="{StaticResource SystemControlFocusVisualSecondaryBrush}" Width="40" Height="40" Padding="-5" Command="{Binding Vote}" CommandParameter="1" >
                        <FontIcon FontSize="32" Foreground="White" FontFamily="{StaticResource ImgurGlyphs}" Glyph="&#xe90b;"/>
                    </Button>
                    <Grid x:Name="VotesPanel" MinWidth="0" Width="40" Visibility="{Binding ReloadingCurrentMediaInfo,Converter={StaticResource BoolNegationConverter}}">
                        <FontIcon Margin="0,-30,0,0" FontFamily="{StaticResource FluentUIGlyphs}" FontSize="20" Glyph="&#xE971;" Opacity="0.5"/>
                        <Grid>
                            <TextBlock Padding="10,0,10,0" Width="40"   Margin="0,0,0,0"  VerticalAlignment="Center" FontSize="12" FontWeight="SemiBold" Text="{Binding CurrentMedia.Votes}" HorizontalAlignment="Center"/>
                        </Grid>
                        <Interactivity:Interaction.Behaviors>

                            <Core:EventTriggerBehavior EventName="Tapped">
                                <Core:ChangePropertyAction TargetObject="{Binding ElementName=ToggleThemeTeachingTip1}" PropertyName="IsOpen" Value="{Binding ElementName=ToggleThemeTeachingTip1,Path=IsOpen,Converter={StaticResource BoolNegationConverter} }">

                                </Core:ChangePropertyAction>
                            </Core:EventTriggerBehavior>
                        </Interactivity:Interaction.Behaviors>
                    </Grid>

                    <ProgressRing Visibility="{Binding ReloadingCurrentMediaInfo}" Width="20" Height="10" Margin="10,0"  Foreground="White" IsActive="{Binding ReloadingCurrentMediaInfo}" />
                    <Button Background="Transparent" BorderBrush="Transparent"  FocusVisualPrimaryBrush="{StaticResource SystemControlFocusVisualPrimaryBrush}" FocusVisualSecondaryBrush="{StaticResource SystemControlFocusVisualSecondaryBrush}"  Width="40" Height="40" Padding="-5" Command="{Binding Vote}" CommandParameter="0">
                        <Button.Content>
                            <FontIcon FontSize="32" Foreground="White" FontFamily="{StaticResource ImgurGlyphs}" Glyph="&#xe900;"/>
                        </Button.Content>
                    </Button>
                </StackPanel>


                <Button Background="Transparent" Grid.Column="1" BorderBrush="Transparent" HorizontalAlignment="Center" Command="{Binding Favourite}"  MinWidth="40" Height="40"  ToolTipService.ToolTip="Reload"  FocusVisualPrimaryBrush="{StaticResource SystemControlFocusVisualPrimaryBrush}" FocusVisualSecondaryBrush="{StaticResource SystemControlFocusVisualSecondaryBrush}" Padding="-5">
                    <Button.Content>
                        <FontIcon Margin="0,0,0,0" FontFamily="{StaticResource FluentUIGlyphs}" FontSize="18" Glyph="&#xEB51;"/>
                    </Button.Content>
                </Button>

                <Button Background="Transparent" Grid.Column="2" BorderBrush="Transparent" Command="{Binding ReloadCurrentMediaInfo}"  HorizontalAlignment="Center" MinWidth="40"  Height="40"  ToolTipService.ToolTip="Reload"  FocusVisualPrimaryBrush="{StaticResource SystemControlFocusVisualPrimaryBrush}" FocusVisualSecondaryBrush="{StaticResource SystemControlFocusVisualSecondaryBrush}" Padding="-5">
                    <Button.Content>
                        <FontIcon Margin="0,0,0,0" FontFamily="{StaticResource FluentUIGlyphs}" FontSize="18" Glyph="&#xE777;"/>
                    </Button.Content>
                </Button>
                <Button Background="Transparent" Grid.Column="3" BorderBrush="Transparent"  Width="40" Height="40" HorizontalAlignment="Center" ToolTipService.ToolTip="Move to Top" Click="NavigateToTop_Click"  FocusVisualPrimaryBrush="{StaticResource SystemControlFocusVisualPrimaryBrush}" FocusVisualSecondaryBrush="{StaticResource SystemControlFocusVisualSecondaryBrush}" Padding="-5">
                    <Button.Content>
                        <FontIcon Margin="0,0,0,0" FontFamily="{StaticResource FluentUIGlyphs}" FontSize="18"  Glyph="&#xE74A;"/>
                    </Button.Content>
                </Button>

                <winui:TeachingTip x:Name="ToggleThemeTeachingTip1" Target="{x:Bind VotesPanel}" IsOpen="False"  DataContext="{Binding CurrentMedia}" HeroContentPlacement="Auto">
                    <winui:TeachingTip.HeroContent>
                        <Button Grid.Row="0" Height="50" Margin="1" HorizontalAlignment="Stretch" BorderThickness="2" Click="ScrollToComments_Click"  BorderBrush="{StaticResource SystemControlAccentAcrylicElementAccentMediumHighBrush}" Foreground="{StaticResource SystemControlAccentAcrylicElementAccentMediumHighBrush}"  FontWeight="SemiBold">
                            <Button.Content>
                                <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Transparent">
                                    <TextBlock MaxWidth="80" FontSize="10" TextWrapping="Wrap" TextAlignment="Center">Jump to Comments</TextBlock>
                                    <Interactivity:Interaction.Behaviors>
                                        <Core:EventTriggerBehavior EventName="Tapped">
                                            <Core:ChangePropertyAction TargetObject="{Binding ElementName=ToggleThemeTeachingTip1}" PropertyName="IsOpen" Value="False">
                                            </Core:ChangePropertyAction>
                                        </Core:EventTriggerBehavior>
                                    </Interactivity:Interaction.Behaviors>
                                </Grid>
                            </Button.Content>
                        </Button>
                    </winui:TeachingTip.HeroContent>
                    <winui:TeachingTip.Content>
                        <StackPanel Background="Transparent" HorizontalAlignment="Center" Padding="5" Margin="0,-15,5,0"  Width="110"  >
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <FontIcon Margin="0,0,3,0" FontSize="27" FontFamily="{StaticResource ImgurGlyphs}"  Glyph="&#xe90b;"/>
                                <TextBlock FontWeight="SemiBold" Text="{Binding Ups,Mode=OneWay}" VerticalAlignment="Center" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <FontIcon Margin="0,0,3,0" FontSize="27" FontFamily="{StaticResource ImgurGlyphs}"   Glyph="&#xe900;"/>
                                <TextBlock FontWeight="SemiBold" Text="{Binding Downs,Mode=OneWay}" VerticalAlignment="Center" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <FontIcon Margin="5,0,8,0" FontFamily="{StaticResource FluentUIGlyphs}" FontSize="17"  FontWeight="ExtraBold" Glyph="&#xEB51;"/>
                                <TextBlock FontWeight="SemiBold" Text="{Binding Likes,Mode=OneWay,FallbackValue=0}" VerticalAlignment="Center" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <FontIcon Margin="5,0,8,0" FontSize="17" FontFamily="{StaticResource FluentUIGlyphs}" FontWeight="ExtraBold"  Glyph="&#xE890;"/>
                                <TextBlock FontWeight="SemiBold" Text="{Binding Views,Mode=OneWay,FallbackValue=0}" VerticalAlignment="Center" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <FontIcon Margin="3,0,6,0" FontSize="22" FontFamily="{StaticResource ImgurGlyphs}" Glyph="&#xe90a;"/>
                                <TextBlock FontWeight="SemiBold" Text="{Binding CommentCount,Mode=OneWay,FallbackValue=0}" VerticalAlignment="Center" />
                            </StackPanel>
                        </StackPanel>
                    </winui:TeachingTip.Content>

                </winui:TeachingTip>
            </Grid>
        </toolkit:DropShadowPanel>

        <!-- Minimal Bottom Bar -->
        <toolkit:DropShadowPanel x:Name="FloatCommandBar" Visibility="Collapsed" Grid.ColumnSpan="3" VerticalAlignment="Bottom" OffsetY="3" Margin="10" BlurRadius="24" ShadowOpacity="0.6" Opacity="0.9"  >
            <Grid  Background="{StaticResource SystemControlBackgroundAccentBrush}" CornerRadius="24"  Height="48">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto" />
                    <ColumnDefinition Width="auto" />
                </Grid.ColumnDefinitions>
                <StackPanel Orientation="Horizontal" Margin="10,0">
                    <Button Background="Transparent" BorderBrush="Transparent" FocusVisualPrimaryBrush="{StaticResource SystemControlFocusVisualPrimaryBrush}" FocusVisualSecondaryBrush="{StaticResource SystemControlFocusVisualSecondaryBrush}" Width="40" Height="40" Padding="-5" Command="{Binding Vote}" CommandParameter="1" >
                        <FontIcon FontSize="32" Foreground="White" FontFamily="{StaticResource ImgurGlyphs}" Glyph="&#xe90b;"/>
                    </Button>
                    <TextBlock Padding="5,0" VerticalAlignment="Center" FontSize="14" FontWeight="SemiBold" Text="{Binding CurrentMedia.Votes}" HorizontalAlignment="Center" Visibility="{Binding ReloadingCurrentMediaInfo,Converter={StaticResource BoolNegationConverter}}" />
                    <ProgressRing Visibility="{Binding ReloadingCurrentMediaInfo}" Width="20" Height="20" Foreground="White" IsActive="{Binding ReloadingCurrentMediaInfo}" />

                    <Button Background="Transparent" BorderBrush="Transparent" FocusVisualPrimaryBrush="{StaticResource SystemControlFocusVisualPrimaryBrush}" FocusVisualSecondaryBrush="{StaticResource SystemControlFocusVisualSecondaryBrush}"  Width="40" Height="40" Padding="-5" Command="{Binding Vote}" CommandParameter="0">
                        <Button.Content>
                            <FontIcon FontSize="32" Foreground="White" FontFamily="{StaticResource ImgurGlyphs}" Glyph="&#xe900;"/>
                        </Button.Content>
                    </Button>
                </StackPanel>

                <AppBarSeparator Foreground="White" Opacity="0.7" HorizontalAlignment="Right" />

                <Button Grid.Column="1" Margin="0,0,6,0" Width="40" Height="40" Background="Transparent" BorderBrush="Transparent">
                    <Button.Content>
                        <FontIcon   FontFamily="{StaticResource FluentUIGlyphs}" FontSize="20" Glyph="&#xE971;" Opacity="0.9" />
                    </Button.Content>
                    <Button.Flyout>
                        <Flyout Placement="Top">
                            <Grid Margin="-15"  Background="Transparent" >
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="1" Margin="10,0,10,0" Visibility="{Binding ReloadingCurrentMediaInfo,Converter={StaticResource BoolNegationConverter}}">
                                    <StackPanel Background="Transparent" HorizontalAlignment="Center" Padding="5" Margin="0,-5,5,0"  MinWidth="100" DataContext="{Binding CurrentMedia}" >
                                        <StackPanel Orientation="Horizontal" Margin="0,5">
                                            <FontIcon Margin="0,0,3,0" FontSize="27" FontFamily="{StaticResource ImgurGlyphs}"  Glyph="&#xe90b;"/>
                                            <TextBlock FontWeight="SemiBold" Text="{Binding Ups,Mode=OneWay}" VerticalAlignment="Center" />
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,5">
                                            <FontIcon Margin="0,0,3,0" FontSize="27" FontFamily="{StaticResource ImgurGlyphs}"   Glyph="&#xe900;"/>
                                            <TextBlock FontWeight="SemiBold" Text="{Binding Downs,Mode=OneWay}" VerticalAlignment="Center" />
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,5">
                                            <FontIcon Margin="5,0,8,0" FontFamily="{StaticResource FluentUIGlyphs}" FontSize="17"  FontWeight="ExtraBold" Glyph="&#xEB51;"/>
                                            <TextBlock FontWeight="SemiBold" Text="{Binding Likes,Mode=OneWay,FallbackValue=0}" VerticalAlignment="Center" />
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,5">
                                            <FontIcon Margin="5,0,8,0" FontSize="17" FontFamily="{StaticResource FluentUIGlyphs}" FontWeight="ExtraBold"  Glyph="&#xE890;"/>
                                            <TextBlock FontWeight="SemiBold" Text="{Binding Views,Mode=OneWay,FallbackValue=0}" VerticalAlignment="Center" />
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,5">
                                            <FontIcon Margin="3,0,6,0" FontSize="22" FontFamily="{StaticResource ImgurGlyphs}" Glyph="&#xe90a;"/>
                                            <TextBlock FontWeight="SemiBold" Text="{Binding CommentCount,Mode=OneWay,FallbackValue=0}" VerticalAlignment="Center" />
                                        </StackPanel>
                                    </StackPanel>
                                </Grid>
                                <Button Grid.Row="0" Height="50" Margin="1" HorizontalAlignment="Stretch" BorderThickness="2"  Click="ScrollToComments_Click"  BorderBrush="{StaticResource SystemControlAccentAcrylicElementAccentMediumHighBrush}" Foreground="{StaticResource SystemControlAccentAcrylicElementAccentMediumHighBrush}"  FontWeight="SemiBold">
                                    <Button.Content>
                                        <TextBlock MaxWidth="80" FontSize="10" TextWrapping="Wrap" TextAlignment="Center">Jump to Comments</TextBlock>
                                    </Button.Content>
                                    <Interactivity:Interaction.Behaviors>
                                        <Core:EventTriggerBehavior EventName="Tapped">
                                            <Core:ChangePropertyAction TargetObject="{Binding ElementName=ToggleThemeTeachingTip1}" PropertyName="IsOpen" Value="False">
                                            </Core:ChangePropertyAction>
                                        </Core:EventTriggerBehavior>
                                    </Interactivity:Interaction.Behaviors>
                                </Button>
                                <ProgressRing Grid.Row="1" Visibility="{Binding ReloadingCurrentMediaInfo}" Width="20" Height="20" Foreground="White" IsActive="{Binding ReloadingCurrentMediaInfo}" Margin="20" />
                            </Grid>
                        </Flyout>
                    </Button.Flyout>
                </Button>
            </Grid>
        </toolkit:DropShadowPanel>
        
        <!-- Reload and Go to Top -->
        <StackPanel Grid.Column="0" Grid.ColumnSpan="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="10" VerticalAlignment="Bottom" x:Name="BottomNavigationBar" Visibility="Collapsed">
            <toolkit:DropShadowPanel  OffsetY="5" OffsetX="0" BlurRadius="20" ShadowOpacity="0.4" Opacity="0.9">
                <Button Style="{StaticResource CircleButtonStyle}" Background="{StaticResource SystemControlBackgroundAccentBrush}" Command="{Binding ReloadCurrentMediaInfo}" Width="48" Height="48" ToolTipService.ToolTip="Refresh Gallery">
                    <FontIcon Visibility="Visible" Grid.Column="0" FontSize="18" FontWeight="Normal"  VerticalAlignment="Center" FontFamily="{StaticResource SegoeMDLGlyphs}" Foreground="WhiteSmoke" Glyph="&#xE72C;"/>
                </Button>
            </toolkit:DropShadowPanel>
            <toolkit:DropShadowPanel  OffsetY="5" OffsetX="0" BlurRadius="20" ShadowOpacity="0.4" Opacity="0.9"  Margin="10,0,0,0">
                <Button Style="{StaticResource CircleButtonStyle}" Background="{StaticResource SystemControlBackgroundAccentBrush}" Click="NavigateToTop_Click" Width="48" Height="48" IsEnabled="{Binding CanScrollToTop, FallbackValue='False'}" ToolTipService.ToolTip="Move to the top"  >
                    <FontIcon Visibility="Visible"  Grid.Column="0" FontSize="18" FontWeight="Normal" HorizontalAlignment="Center" VerticalAlignment="Center" FontFamily="{StaticResource SegoeMDLGlyphs}" Foreground="WhiteSmoke" Glyph="&#xE898;"/>
                </Button>
            </toolkit:DropShadowPanel>
        </StackPanel>
    </Grid>
</Page>
